---
import BlockRenderer from '../BlockRenderer.astro';
import PageIntro from '../PageIntro.astro'
import PageTitle from '../PageTitle.astro';

const { data } = Astro.props;

// Null-safe data extraction
const pageTitle = data?.title || 'Untitled Page';

// Check for Sanity vs WordPress data structure
const isSanity = data?._type !== undefined;
const isWordPress = data?.__typename !== undefined;

// Sanity data structure
const pageHero = isSanity ? data?.hero : data?.pageHero;
const pageHeroTitle = pageHero?.title || pageTitle;
const pageHeroColOne = isSanity ? pageHero?.col1 : pageHero?.intro?.col1;
const pageHeroColTwo = isSanity ? pageHero?.col2 : pageHero?.intro?.col2;

// Content handling
const pageIntroduction = isSanity ? data?.introCols?.[0]?.content : data?.content;
const pageContent = isSanity ? data?.content : data?.pageContent?.content;
---


{pageHero ?
  <PageTitle title={pageHeroTitle} />
  <PageIntro class="page">
    <Fragment slot="column-one" set:html={pageHeroColOne} />
    <Fragment slot="column-two" set:html={pageHeroColTwo} />
  </PageIntro>
:
  <PageTitle title={pageTitle} />
  <PageIntro>
    {pageIntroduction &&
      <Fragment slot="column-one" set:html={pageIntroduction} />
    }
  </PageIntro>
}

{pageContent && (
    <article class="page">
      <BlockRenderer prefix="PageContent" blocks={pageContent} />
    </article>
  )
}

<style>
  .page {
    padding: var(--site-padding);
  }
</style>
